<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>JPush HBuilder Demo</title>
  <link href="../css/jquery.mobile-1.1.1.css" rel="stylesheet"/>
  <script src="../js/jquery.js"></script>
  <script src="../js/jquery.mobile-1.1.1.js"></script>
  <script src="../js/common.js"></script>
  <script src="../js/jpush.js"></script>
  <script type="text/javascript">
      var setAliasAndTags = function() {
    	  var tag1 = $("#tagText1").attr("value");
    	  var tag2 = $("#tagText2").attr("value");
    	  var tag3 = $("#tagText3").attr("value");
    	  var alias = $("#aliasText").attr("value");
    	  var tags = [];

    	  if (tag1 != "") {
    	      tags.push(tag1);
    	  }
    	  if (tag2 != "") {
    	      tags.push(tag2);
    	  }
    	  if (tag3 != "") {
    	      tags.push(tag3);
    	  }
    	  plus.JPush.setAliasAndTags(alias, tags); 
      };
      
      var getRegistrationId = function() {
    	  plus.JPush.getRegistrationId(function(data) {
			  if(data.length != 0) {
				  $("#registrationId").html(data);
			  }
		  });
      };
      
      var receiveNotification = function() {
    	 var content = plus.JPush.receiveNotification.alert;
         $("#notificationResult").html(content);
      };
      
      var openNotification = function() {
    	 var content = plus.JPush.openNotification.alert;
    	 alert(content);
      };
      
      var receiveMessage = function() {
    	 var msg = plus.JPush.receiveMessage.message;
    	 $("#messageResult").html(msg);
      };

      var onAliasAndTagsSeted = function(event) {
          var result = "result code: " + event.arguments.resultCode + " ";
          result += "tags: " + event.arguments.tags + " ";
          result += "alias: " + event.arguments.alias + " ";
          $("#tagAliasResult").html(result);
      };
      
      document.addEventListener("jpush.receiveMessage", receiveMessage, false);
      document.addEventListener("jpush.receiveNotification", receiveNotification, false);
      document.addEventListener("jpush.openNotification", openNotification, false);
      document.addEventListener("jpush.setTagsWithAlias", onAliasAndTagsSeted, false);
  </script>
</head>

<body>
  <div data-role="page" id="page">
    <div data-role="content">
      <form>
        <div class="ui-body ui-body-b">

          <div data-role="fieldcontain">
            <center>
              <h3>JPushPlugin Example</h3>
            </center>
            <span id="alias"></span>
            <hr/>
            <label>RegistrationID: </label>
            <label id="registrationId">null</label>
          </div>

          <div data-role="fieldcontain">
            <label>Tags: </label>
            <table>
              <tr>
                <td>
                  <input type="text" id="tagText1" />
                </td>
              </tr>
              <tr>
                <td>
                  <input type="text" id="tagText2" />
                </td>
              </tr>
              <tr>
                <td>
                  <input type="text" id="tagText3">
                </td>
              </tr>
            </table>
            <label>Alias: </label>
            <table>
              <tr>
                <td>
                  <input type="text" id="aliasText">
                </td>
              </tr>
            </table>
          </div>

          <div data-role="fieldcontain">
            <input type="button" id="setTagWithAliasButton" 
                value="Add tag and alias" 
                onclick="setAliasAndTags()" />

            <input type="button" id="addLocalNotification" 
                onclick="plus.JPush.addLocalNotification(0, 'local notification',
                		'title', 1, 0, null)" 
                value="Add local notification" />

            <input type="button" id="getRegistrationID" 
                onclick="getRegistrationId()"
                value="Get registration ID" />
          </div>

          <div data-role="fieldcontain">
            <label id="tagAliasPrompt">设置tag/alias结果:</label>
            <label id="tagAliasResult">null</label>
          </div>

          <div data-role="fieldcontain">
            <label id="notificationPrompt">接受的通知内容:</label>
            <label id="notificationResult">null</label>
          </div>

          <div data-role="fieldcontain">
            <label id="messagePrompt">接受的自定义消息:</label>
            <label id="messageResult">null</label>
          </div>

        </div>
      </form>
    </div>
  </div>
</body>

</html>
